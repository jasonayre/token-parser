!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).TokenParser=t()}}(function(){return function t(e,n,i){function r(o,h){if(!n[o]){if(!e[o]){var a="function"==typeof require&&require;if(!h&&a)return a(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};e[o][0].call(c.exports,function(t){var n=e[o][1][t];return r(n||t)},c,c.exports,t,e,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,n){function i(t){this.lexer=new s,this.scanCache=!1!==t&&{},this.compileCache=!1!==t&&{},this.errorHandlers=[],this.nodeTypes={},this.expressions=new r(t)}var r=t("./lib/expression-parser"),s=t("./lib/lexer"),o=t("./lib/node-types"),h=o.COMPOUND;i.prototype.init=function(){this.lexer.init();for(var t in o)o.hasOwnProperty(t)&&this.nodeType(t,o[t])},i.prototype.nodeType=function(t,e){return void 0===e?this.nodeTypes[t]:this.nodeTypes[t]=e;var e},i.prototype.filter=function(t,e){if(void 0===e)return this.expressions.filters[t];if(!1===typeof e){var e=this.expressions.filters[t];return delete this.expressions.filters[t],e}return this.expressions.filters[t]=e},i.prototype.scan=function(t){if(this.lexer||!this.throwError("TokenParser must be initialized")){if(this.scanCache&&this.scanCache[t])return this.scanCache[t];this.lexer.setInput(t);for(var e,n=[];void 0!==(e=this.lexer.lex());)n.push(e);return this.scanCache&&(this.scanCache[t]=n),n}},i.prototype.parse=function(t){for(var e,n=[],i=0;i<t.length;)(e=o[t[i].type].parse.call(this,t[i],i,t))&&n.push(e),i++;return n},i.prototype.compile=function(t){if(this.compileCache&&this.compileCache[t])return this.compileCache[t];var e=this.parse(this.scan(t)),n=new h(e);return this.compileCache&&(this.compileCache[t]=n),n},i.prototype.replace=function(t,e){return this.compile(t).replace(e)},i.prototype.addErrorHandler=function(t){this.errorHandlers.push(t)},i.prototype.removeErrorHandler=function(t){var e;(e=this.errorHandlers.indexOf(t)>-1)&&this.errorHandlers.splice(e,1)},i.prototype.throwError=function(){var t,e=[].slice.call(arguments);for(t=0;t<this.errorHandlers.length;t++)if(!0===this.errorHandlers[t].apply(this,e))return!0;throw new Error(e[0])},e.exports=i},{"./lib/expression-parser":2,"./lib/lexer":3,"./lib/node-types":12}],2:[function(t,e,n){var i=t("angular-expressions");e.exports=function(t){function e(t){var n;if("string"!=typeof t)throw new TypeError("src must be a string, instead saw '"+typeof t+"'");return e.cache?((n=e.cache[t])||(n=e.cache[t]=o.parse(t)),n):o.parse(t)}var n={},r=i.Lexer,s=i.Parser,o=new s(new r({}),function(t){return n[t]});e.cache=!1!==t&&{},this.Lexer=r,this.Parser=s,this.compile=e,this.filters=n}},{"angular-expressions":14}],3:[function(t,e,n){var i=e.exports=t("lex"),r=t("./states"),s=t("./rules");i.prototype.init=function(){this.postponed=[],this.errorHandlers=[],this.states=r;for(var t=0;t<s.length;t++)this.addRule(s[t].regex,s[t].action,s[t].start)},i.prototype.pushState=function(t){(this.stateTrail=this.stateTrail||[0]).push(this.state=t)},i.prototype.popState=function(t){for(this.stateTrail=this.stateTrail||[0];t&&this.stateTrail[this.stateTrail.length-1]!==t;)this.stateTrail.splice(-1);this.stateTrail.splice(-1),this.state=this.stateTrail[this.stateTrail.length-1]||0},i.prototype.hasState=function(t){return~this.stateTrail.indexOf(t)},i.prototype.postpone=function(t){this.postponed.push(t)},i.prototype.expedite=function(){return this.postponed.splice(0)},i.prototype.addErrorHandler=function(t){this.errorHandlers.push(t)},i.prototype.removeErrorHandler=function(t){var e;(e=this.errorHandlers.indexOf(t)>-1)&&this.errorHandlers.splice(e,1)},i.prototype.throwError=function(t){var e,n=[].slice.call(arguments);for(e=0;e<this.errorHandlers.length;e++)if(!0===this.errorHandlers[e].apply(this,n))return!0;if(this.state)throw new Error("Unexpected character at index "+(this.index-1)+": "+t)},i.defunct=i.prototype.throwError},{"./rules":7,"./states":9,lex:16}],4:[function(t,e,n){e.exports={name:"End",regex:/$/,action:function(t){var e=this.expedite();if(e.length)return{type:"STRING",value:e.join("")}},start:[0]}},{}],5:[function(t,e,n){var i=t("../states");e.exports={name:"Expression end",regex:/\}}/,action:function(t){return this.popState(i.EXPRESSION),{type:"/EXPRESSION"}},start:[i.EXPRESSION]}},{"../states":9}],6:[function(t,e,n){var i=t("../states");e.exports={name:"Expression start",regex:/\{{/,action:function(t){return this.pushState(i.EXPRESSION),{type:"EXPRESSION"}},start:[0,i.EXPRESSION]}},{"../states":9}],7:[function(t,e,n){e.exports=[t("./expression-start"),t("./expression-end"),t("./string"),t("./end")]},{"./end":4,"./expression-end":5,"./expression-start":6,"./string":8}],8:[function(t,e,n){var i=t("../states");e.exports={name:"String",regex:/./gi,action:function(t){return{type:"STRING",value:t}},start:[0,i.EXPRESSION]}},{"../states":9}],9:[function(t,e,n){e.exports={STRING:2,EXPRESSION:4}},{}],10:[function(t,e,n){function i(t){this.raw=this.nodes=t}i.prototype.replace=function(t){for(var e="",n=0;n<this.nodes.length;n++)e+=this.nodes[n].replace(t);return e},e.exports=i},{}],11:[function(t,e,n){function i(t,e){this.raw=t,this.nodes=t,this.expressions=e}i.prototype.replace=function(t){for(var e="",n=0;n<this.nodes.length;n++)e+=this.nodes[n].replace(t);return this.expressions.compile(e)(t)},i.parse=function(t,e,n){for(var r=e+1,s=[],o=!1;n[r]&&!o;){switch(n[r].type){case"/EXPRESSION":o=!0;break;default:s.push(this.nodeTypes[n[r].type].parse.call(this,n[r],r,n))}n.splice(r,1)}return new i(s,this.expressions)},e.exports=i},{}],12:[function(t,e,n){e.exports={STRING:t("./string"),COMPOUND:t("./compound"),EXPRESSION:t("./expression")}},{"./compound":10,"./expression":11,"./string":13}],13:[function(t,e,n){function i(t){this.raw=t}i.prototype.replace=function(){return this.raw},i.parse=function(t,e,n){for(var r=t.value,s=e+1;n[s]&&"STRING"===n[s].type;)r+=n.splice(s,1)[0].value||"";return new i(r)},e.exports=i},{}],14:[function(t,e,n){"use strict";function i(t){var e;if("string"!=typeof t)throw new TypeError("src must be a string, instead saw '"+typeof t+"'");return i.cache?((e=i.cache[t])||(e=i.cache[t]=a.parse(t)),e):a.parse(t)}var r=t("./parse.js"),s={},o=r.Lexer,h=r.Parser,a=new h(new o({}),function(t){return s[t]});i.cache={},n.Lexer=o,n.Parser=h,n.compile=i,n.filters=s},{"./parse.js":15}],15:[function(t,e,n){"use strict";function i(){}function r(t,e){var n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function s(t){return void 0!==t}function o(t){return function(){return t}}function h(t,e,n,i,r){var s=arguments;throw e=e.replace(/{(\d)}/g,function(t){return s[2+parseInt(t[1])]}),new SyntaxError(e)}function a(t){return"string"==typeof t?t.toLowerCase():t}function u(t,e){t.forEach(e)}function c(t,e){if("constructor"===t)throw h("isecfld",'Referencing "constructor" field in Angular expressions is disallowed! Expression: {0}',e);return t}function f(t,e){if(t){if(t.constructor===t)throw h("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",e);if(t.document&&t.location&&t.alert&&t.setInterval)throw h("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",e);if(t.children&&(t.nodeName||t.prop&&t.attr&&t.find))throw h("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",e)}return t}function p(t,e,n,i){for(var r,s=e.split("."),o=0;s.length>1;o++){var h=t[r=c(s.shift(),i)];h||(h={},t[r]=h),t=h}return r=c(s.shift(),i),t[r]=n,n}function l(t,e,n,i,r,s){return c(t,s),c(e,s),c(n,s),c(i,s),c(r,s),function(s,o){var h=o&&o.hasOwnProperty(t)?o:s;if(null==h)return h;if(h=h[t],!e)return h;if(null!=h){if(h=h[e],!n)return h;if(null!=h){if(h=h[n],!i)return h;if(null!=h){if(h=h[i],!r)return h;if(null!=h)return h=h[r]}}}}}function x(t,e){return c(t,e),function(e,n){if(null!=e)return(n&&n.hasOwnProperty(t)?n:e)[t]}}function d(t,e,n){return c(t,n),c(e,n),function(n,i){if(null!=n)return null==(n=(i&&i.hasOwnProperty(t)?i:n)[t])?void 0:n[e]}}function v(t,e,n){if(E.hasOwnProperty(t))return E[t];var i,r=t.split("."),s=r.length;if(1===s)i=x(r[0],n);else if(2===s)i=d(r[0],r[1],n);else if(e.csp)i=s<6?l(r[0],r[1],r[2],r[3],r[4],n,e):function(t,i){var o,h=0;do{o=l(r[h++],r[h++],r[h++],r[h++],r[h++],n,e)(t,i),i=void 0,t=o}while(h<s);return o};else{var h="var p;\n";u(r,function(t,e){c(t,n),h+="if(s == null) return undefined;\ns="+(e?"s":'((k&&k.hasOwnProperty("'+t+'"))?k:s)')+'["'+t+'"];\n'}),h+="return s;";var a=new Function("s","k","pw",h);a.toString=o(h),i=a}return"hasOwnProperty"!==t&&(E[t]=i),i}var y={null:function(){return null},true:function(){return!0},false:function(){return!1},undefined:i,"+":function(t,e,n,i){return n=n(t,e),i=i(t,e),s(n)?s(i)?n+i:n:s(i)?i:void 0},"-":function(t,e,n,i){return n=n(t,e),i=i(t,e),(s(n)?n:0)-(s(i)?i:0)},"*":function(t,e,n,i){return n(t,e)*i(t,e)},"/":function(t,e,n,i){return n(t,e)/i(t,e)},"%":function(t,e,n,i){return n(t,e)%i(t,e)},"^":function(t,e,n,i){return n(t,e)^i(t,e)},"=":i,"===":function(t,e,n,i){return n(t,e)===i(t,e)},"!==":function(t,e,n,i){return n(t,e)!==i(t,e)},"==":function(t,e,n,i){return n(t,e)==i(t,e)},"!=":function(t,e,n,i){return n(t,e)!=i(t,e)},"<":function(t,e,n,i){return n(t,e)<i(t,e)},">":function(t,e,n,i){return n(t,e)>i(t,e)},"<=":function(t,e,n,i){return n(t,e)<=i(t,e)},">=":function(t,e,n,i){return n(t,e)>=i(t,e)},"&&":function(t,e,n,i){return n(t,e)&&i(t,e)},"||":function(t,e,n,i){return n(t,e)||i(t,e)},"&":function(t,e,n,i){return n(t,e)&i(t,e)},"|":function(t,e,n,i){return i(t,e)(t,e,n(t,e))},"!":function(t,e,n){return!n(t,e)}},g={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},w=function(t){this.options=t};w.prototype={constructor:w,lex:function(t){this.text=t,this.index=0,this.ch=void 0,this.lastCh=":",this.tokens=[];for(var e,n=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent(),this.was("{,")&&"{"===n[0]&&(e=this.tokens[this.tokens.length-1])&&(e.json=-1===e.text.indexOf("."));else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch,json:this.was(":[,")&&this.is("{[")||this.is("}]:,")}),this.is("{[")&&n.unshift(this.ch),this.is("}]")&&n.shift(),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var i=this.ch+this.peek(),r=i+this.peek(2),s=y[this.ch],o=y[i],h=y[r];h?(this.tokens.push({index:this.index,text:r,fn:h}),this.index+=3):o?(this.tokens.push({index:this.index,text:i,fn:o}),this.index+=2):s?(this.tokens.push({index:this.index,text:this.ch,fn:s,json:this.was("[,:")&&this.is("+-")}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(t){return-1!==t.indexOf(this.ch)},was:function(t){return-1!==t.indexOf(this.lastCh)},peek:function(t){var e=t||1;return this.index+e<this.text.length&&this.text.charAt(this.index+e)},isNumber:function(t){return"0"<=t&&t<="9"},isWhitespace:function(t){return" "===t||"\r"===t||"\t"===t||"\n"===t||"\v"===t||"Â "===t},isIdent:function(t){return"a"<=t&&t<="z"||"A"<=t&&t<="Z"||"_"===t||"$"===t},isExpOperator:function(t){return"-"===t||"+"===t||this.isNumber(t)},throwError:function(t,e,n){throw n=n||this.index,h("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",t,s(e)?"s "+e+"-"+this.index+" ["+this.text.substring(e,n)+"]":" "+n,this.text)},readNumber:function(){for(var t="",e=this.index;this.index<this.text.length;){var n=a(this.text.charAt(this.index));if("."==n||this.isNumber(n))t+=n;else{var i=this.peek();if("e"==n&&this.isExpOperator(i))t+=n;else if(this.isExpOperator(n)&&i&&this.isNumber(i)&&"e"==t.charAt(t.length-1))t+=n;else{if(!this.isExpOperator(n)||i&&this.isNumber(i)||"e"!=t.charAt(t.length-1))break;this.throwError("Invalid exponent")}}this.index++}t*=1,this.tokens.push({index:e,text:t,json:!0,fn:function(){return t}})},readIdent:function(){for(var t,e,n,i,s=this,o="",h=this.index;this.index<this.text.length&&("."===(i=this.text.charAt(this.index))||this.isIdent(i)||this.isNumber(i));)"."===i&&(t=this.index),o+=i,this.index++;if(t)for(e=this.index;e<this.text.length;){if("("===(i=this.text.charAt(e))){n=o.substr(t-h+1),o=o.substr(0,t-h),this.index=e;break}if(!this.isWhitespace(i))break;e++}var a={index:h,text:o};if(y.hasOwnProperty(o))a.fn=y[o],a.json=y[o];else{var u=v(o,this.options,this.text);a.fn=r(function(t,e){return u(t,e)},{assign:function(t,e){return p(t,o,e,s.text,s.options)}})}this.tokens.push(a),n&&(this.tokens.push({index:t,text:".",json:!1}),this.tokens.push({index:t+1,text:n,json:!1}))},readString:function(t){var e=this.index;this.index++;for(var n="",i=t,r=!1;this.index<this.text.length;){var s=this.text.charAt(this.index);if(i+=s,r){if("u"===s){var o=this.text.substring(this.index+1,this.index+5);o.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+o+"]"),this.index+=4,n+=String.fromCharCode(parseInt(o,16))}else{var h=g[s];n+=h||s}r=!1}else if("\\"===s)r=!0;else{if(s===t)return this.index++,void this.tokens.push({index:e,text:i,string:n,json:!0,fn:function(){return n}});n+=s}this.index++}this.throwError("Unterminated quote",e)}};var m=function(t,e,n){this.lexer=t,this.$filter=e,this.options=n};m.ZERO=function(){return 0},m.prototype={constructor:m,parse:function(t){this.text=t,this.tokens=this.lexer.lex(t);var e=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),e.literal=!!e.literal,e.constant=!!e.constant,e},primary:function(){var t;if(this.expect("("))t=this.filterChain(),this.consume(")");else if(this.expect("["))t=this.arrayDeclaration();else if(this.expect("{"))t=this.object();else{var e=this.expect();(t=e.fn)||this.throwError("not a primary expression",e),e.json&&(t.constant=!0,t.literal=!0)}for(var n,i;n=this.expect("(","[",".");)"("===n.text?(t=this.functionCall(t,i),i=null):"["===n.text?(i=t,t=this.objectIndex(t)):"."===n.text?(i=t,t=this.fieldAccess(t)):this.throwError("IMPOSSIBLE");return t},throwError:function(t,e){throw h("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",e.text,t,e.index+1,this.text,this.text.substring(e.index))},peekToken:function(){if(0===this.tokens.length)throw h("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(t,e,n,i){if(this.tokens.length>0){var r=this.tokens[0],s=r.text;if(s===t||s===e||s===n||s===i||!t&&!e&&!n&&!i)return r}return!1},expect:function(t,e,n,i){var r=this.peek(t,e,n,i);return!!r&&(this.tokens.shift(),r)},consume:function(t){this.expect(t)||this.throwError("is unexpected, expecting ["+t+"]",this.peek())},unaryFn:function(t,e){return r(function(n,i){return t(n,i,e)},{constant:e.constant})},ternaryFn:function(t,e,n){return r(function(i,r){return t(i,r)?e(i,r):n(i,r)},{constant:t.constant&&e.constant&&n.constant})},binaryFn:function(t,e,n){return r(function(i,r){return e(i,r,t,n)},{constant:t.constant&&n.constant})},statements:function(){for(var t=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&t.push(this.filterChain()),!this.expect(";"))return 1===t.length?t[0]:function(e,n){for(var i,r=0;r<t.length;r++){var s=t[r];s&&(i=s(e,n))}return i}},filterChain:function(){for(var t,e=this.expression();;){if(!(t=this.expect("|")))return e;e=this.binaryFn(e,t.fn,this.filter())}},filter:function(){for(var t=this.expect(),e=this.$filter(t.text),n=[];;){if(!(t=this.expect(":"))){var i=function(t,i,r){for(var s=[r],o=0;o<n.length;o++)s.push(n[o](t,i));return e.apply(t,s)};return function(){return i}}n.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var t,e,n=this.ternary();return(e=this.expect("="))?(n.assign||this.throwError("implies assignment but ["+this.text.substring(0,e.index)+"] can not be assigned to",e),t=this.ternary(),function(e,i){return n.assign(e,t(e,i),i)}):n},ternary:function(){var t,e,n=this.logicalOR();return(e=this.expect("?"))?(t=this.ternary(),(e=this.expect(":"))?this.ternaryFn(n,t,this.ternary()):void this.throwError("expected :",e)):n},logicalOR:function(){for(var t,e=this.logicalAND();;){if(!(t=this.expect("||")))return e;e=this.binaryFn(e,t.fn,this.logicalAND())}},logicalAND:function(){var t,e=this.equality();return(t=this.expect("&&"))&&(e=this.binaryFn(e,t.fn,this.logicalAND())),e},equality:function(){var t,e=this.relational();return(t=this.expect("==","!=","===","!=="))&&(e=this.binaryFn(e,t.fn,this.equality())),e},relational:function(){var t,e=this.additive();return(t=this.expect("<",">","<=",">="))&&(e=this.binaryFn(e,t.fn,this.relational())),e},additive:function(){for(var t,e=this.multiplicative();t=this.expect("+","-");)e=this.binaryFn(e,t.fn,this.multiplicative());return e},multiplicative:function(){for(var t,e=this.unary();t=this.expect("*","/","%");)e=this.binaryFn(e,t.fn,this.unary());return e},unary:function(){var t;return this.expect("+")?this.primary():(t=this.expect("-"))?this.binaryFn(m.ZERO,t.fn,this.unary()):(t=this.expect("!"))?this.unaryFn(t.fn,this.unary()):this.primary()},fieldAccess:function(t){var e=this,n=this.expect().text,i=v(n,this.options,this.text);return r(function(e,n,r){return i(r||t(e,n))},{assign:function(i,r,s){return p(t(i,s),n,r,e.text,e.options)}})},objectIndex:function(t){var e=this,n=this.expression();return this.consume("]"),r(function(i,r){var s=t(i,r),o=n(i,r);if(s)return f(s[o],e.text)},{assign:function(i,r,s){var o=n(i,s);return f(t(i,s),e.text)[o]=r}})},functionCall:function(t,e){var n=[];if(")"!==this.peekToken().text)do{n.push(this.expression())}while(this.expect(","));this.consume(")");var r=this;return function(s,o){for(var h=[],a=e?e(s,o):s,u=0;u<n.length;u++)h.push(n[u](s,o));var c=t(s,o,a)||i;return f(a,r.text),f(c,r.text),f(c.apply?c.apply(a,h):c(h[0],h[1],h[2],h[3],h[4]),r.text)}},arrayDeclaration:function(){var t=[],e=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var n=this.expression();t.push(n),n.constant||(e=!1)}while(this.expect(","));return this.consume("]"),r(function(e,n){for(var i=[],r=0;r<t.length;r++)i.push(t[r](e,n));return i},{literal:!0,constant:e})},object:function(){var t=[],e=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var n=this.expect(),i=n.string||n.text;this.consume(":");var s=this.expression();t.push({key:i,value:s}),s.constant||(e=!1)}while(this.expect(","));return this.consume("}"),r(function(e,n){for(var i={},r=0;r<t.length;r++){var s=t[r];i[s.key]=s.value(e,n)}return i},{literal:!0,constant:e})}};var E={};n.Lexer=w,n.Parser=m},{}],16:[function(t,e,n){function i(t){function e(){for(var t=[],e=0,n=this.state,i=this.index,s=this.input,o=0,h=r.length;o<h;o++){var a=r[o],u=a.start,c=u.length;if(!c||u.indexOf(n)>=0||n%2&&1===c&&!u[0]){var f=a.pattern;f.lastIndex=i;var p=f.exec(s);if(p&&p.index===i){var l=t.push({result:p,action:a.action,length:p[0].length});for(a.global&&(e=l);--l>e;){var x=l-1;if(t[l].length>t[x].length){var d=t[l];t[l]=t[x],t[x]=d}}}}}return t}"function"!=typeof t&&(t=i.defunct);var n=[],r=[],s=0;this.state=0,this.index=0,this.input="",this.addRule=function(t,e,n){var i=t.global;if(!i){var s="g";t.multiline&&(s+="m"),t.ignoreCase&&(s+="i"),t=new RegExp(t.source,s)}return"[object Array]"!==Object.prototype.toString.call(n)&&(n=[0]),r.push({pattern:t,global:i,action:e,start:n}),this},this.setInput=function(t){return s=0,this.state=0,this.index=0,n.length=0,this.input=t,this},this.lex=function(){if(n.length)return n.shift();for(this.reject=!0;this.index<=this.input.length;){for(var i=e.call(this).splice(s),r=this.index;i.length&&this.reject;){var o=i.shift(),h=o.result,a=o.length;this.index+=a,this.reject=!1,s++;var u=o.action.apply(this,h);if(this.reject)this.index=h.index;else if(void 0!==u)switch(Object.prototype.toString.call(u)){case"[object Array]":n=u.slice(1),u=u[0];default:return a&&(s=0),u}}var c=this.input;if(r<c.length)if(this.reject){if(s=0,void 0!==(u=t.call(this,c.charAt(this.index++))))return"[object Array]"===Object.prototype.toString.call(u)?(n=u.slice(1),u[0]):u}else this.index!==r&&(s=0),this.reject=!0;else{if(!i.length)break;this.reject=!0}}}}"object"==typeof e&&"object"==typeof e.exports&&(e.exports=i),i.defunct=function(t){throw new Error("Unexpected character at index "+(this.index-1)+": "+t)}},{}]},{},[1])(1)});